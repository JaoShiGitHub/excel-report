{"ast":null,"code":"var _jsxFileName = \"/Users/oshingp/excel-report/src/components/ExportButton.tsx\";\nimport ExcelJS from \"exceljs\";\nimport { saveAs } from \"file-saver\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction MeatSteamGrindingExportButton({\n  meatSteamGrindingExportData\n}) {\n  const workbook = new ExcelJS.Workbook();\n  const sheet = workbook.addWorksheet(\"แบบบันทึกการละลายเนื้อ\");\n\n  // -- HEADER --\n  const generateHeader = () => {\n    console.log(\"header\");\n  };\n\n  // -- TABLES --\n  const generateTables = (tableStartAt, batchData) => {\n    return console.log(\"generateMeatSteamGrindingExcel\");\n  };\n\n  // -- EXCEL FILE GENERATION CONTROLLER --\n  async function handleExport() {\n    generateHeader();\n    generateTables(2, [{\n      date: \"\"\n    }]);\n    // 1. Create header: generateFileHeader()\n    // 2. Create tables the file (loop): generateTables()\n    // 3. Save the file // try ... catch\n\n    // --- Export file ---\n    try {\n      const buffer = await workbook.xlsx.writeBuffer();\n      saveAs(new Blob([buffer]), \"meat-steam.xlsx\");\n    } catch (error) {\n      console.log(\"Error exporing file: \", error);\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    onClick: handleExport,\n    children: \"Export\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 10\n  }, this);\n}\n_c = MeatSteamGrindingExportButton;\nexport default MeatSteamGrindingExportButton;\nvar _c;\n$RefreshReg$(_c, \"MeatSteamGrindingExportButton\");","map":{"version":3,"names":["ExcelJS","saveAs","jsxDEV","_jsxDEV","MeatSteamGrindingExportButton","meatSteamGrindingExportData","workbook","Workbook","sheet","addWorksheet","generateHeader","console","log","generateTables","tableStartAt","batchData","handleExport","date","buffer","xlsx","writeBuffer","Blob","error","onClick","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/oshingp/excel-report/src/components/ExportButton.tsx"],"sourcesContent":["import { JSX, useEffect, useState } from \"react\";\nimport ExcelJS from \"exceljs\";\nimport { saveAs } from \"file-saver\";\nimport dayjs from \"dayjs\";\nimport utc from \"dayjs/plugin/utc\";\n\ninterface BatchData {\n  date: string;\n}\n\ninterface MSGProps {\n  batchCount: number;\n}\n\ninterface ExportButtonProps {\n  meatSteamGrindingExportData: MSGProps[];\n}\n\nfunction MeatSteamGrindingExportButton({\n  meatSteamGrindingExportData,\n}: ExportButtonProps): JSX.Element {\n  const workbook = new ExcelJS.Workbook();\n  const sheet = workbook.addWorksheet(\"แบบบันทึกการละลายเนื้อ\");\n\n  // -- HEADER --\n  const generateHeader = () => {\n    console.log(\"header\");\n  };\n\n  // -- TABLES --\n  const generateTables = (tableStartAt: number, batchData: BatchData[]) => {\n    return console.log(\"generateMeatSteamGrindingExcel\");\n  };\n\n  // -- EXCEL FILE GENERATION CONTROLLER --\n  async function handleExport() {\n    generateHeader();\n    generateTables(2, [{ date: \"\" }]);\n    // 1. Create header: generateFileHeader()\n    // 2. Create tables the file (loop): generateTables()\n    // 3. Save the file // try ... catch\n\n    // --- Export file ---\n    try {\n      const buffer = await workbook.xlsx.writeBuffer();\n      saveAs(new Blob([buffer]), \"meat-steam.xlsx\");\n    } catch (error) {\n      console.log(\"Error exporing file: \", error);\n    }\n  }\n\n  return <button onClick={handleExport}>Export</button>;\n}\n\nexport default MeatSteamGrindingExportButton;\n"],"mappings":";AACA,OAAOA,OAAO,MAAM,SAAS;AAC7B,SAASC,MAAM,QAAQ,YAAY;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAgBpC,SAASC,6BAA6BA,CAAC;EACrCC;AACiB,CAAC,EAAe;EACjC,MAAMC,QAAQ,GAAG,IAAIN,OAAO,CAACO,QAAQ,CAAC,CAAC;EACvC,MAAMC,KAAK,GAAGF,QAAQ,CAACG,YAAY,CAAC,wBAAwB,CAAC;;EAE7D;EACA,MAAMC,cAAc,GAAGA,CAAA,KAAM;IAC3BC,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC;EACvB,CAAC;;EAED;EACA,MAAMC,cAAc,GAAGA,CAACC,YAAoB,EAAEC,SAAsB,KAAK;IACvE,OAAOJ,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC;EACtD,CAAC;;EAED;EACA,eAAeI,YAAYA,CAAA,EAAG;IAC5BN,cAAc,CAAC,CAAC;IAChBG,cAAc,CAAC,CAAC,EAAE,CAAC;MAAEI,IAAI,EAAE;IAAG,CAAC,CAAC,CAAC;IACjC;IACA;IACA;;IAEA;IACA,IAAI;MACF,MAAMC,MAAM,GAAG,MAAMZ,QAAQ,CAACa,IAAI,CAACC,WAAW,CAAC,CAAC;MAChDnB,MAAM,CAAC,IAAIoB,IAAI,CAAC,CAACH,MAAM,CAAC,CAAC,EAAE,iBAAiB,CAAC;IAC/C,CAAC,CAAC,OAAOI,KAAK,EAAE;MACdX,OAAO,CAACC,GAAG,CAAC,uBAAuB,EAAEU,KAAK,CAAC;IAC7C;EACF;EAEA,oBAAOnB,OAAA;IAAQoB,OAAO,EAAEP,YAAa;IAAAQ,QAAA,EAAC;EAAM;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAQ,CAAC;AACvD;AAACC,EAAA,GAlCQzB,6BAA6B;AAoCtC,eAAeA,6BAA6B;AAAC,IAAAyB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}