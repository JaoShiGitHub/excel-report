{"ast":null,"code":"var _jsxFileName = \"/Users/oshingp/excel-report/src/components/ExportButton.tsx\";\nimport ExcelJS from \"exceljs\";\nimport { saveAs } from \"file-saver\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction MeatSteamGrindingExportButton({\n  meatSteamGrindingExportData\n}) {\n  // CHECK IF DATA IS EMPTY\n  if (meatSteamGrindingExportData.length === 0) {\n    return /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"No data available for export.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 12\n    }, this);\n  }\n  const workbook = new ExcelJS.Workbook();\n  const sheet = workbook.addWorksheet(\"แบบบันทึกการละลายเนื้อ\");\n\n  // -- HEADER --\n  const generateHeader = () => {\n    // Title\n    sheet.mergeCells(\"A1:J1\");\n    sheet.getCell(\"A1\").value = \"แบบบันทึกการบดเนื้อสัตว์ (Stir-Fried Meat Grinding Process Check Sheet)\";\n\n    // Leader and supervisor signatures columns\n\n    // const headerCellValues = [\n    //   {\n    //     cell: \"E2\",\n    //     value: \"หัวหน้ากะ 1\",\n    //     signature: \"\",\n    //   },\n    //   {\n    //     cell: \"F2\",\n    //     value: \"หัวหน้ากะ 2\",\n    //     signature: \"\",\n    //   },\n    //   {\n    //     cell: \"G2\",\n    //     value: \"หัวหน้ากะ 3\",\n    //     signature: \"\",\n    //   },\n    //   {\n    //     cell: \"H2\",\n    //     value: \"Supervisor\",\n    //     signature: \"\",\n    //   },\n    // ];\n\n    // headerCellValues.forEach(({ cell, value, signature }) => {\n    //   sheet.getCell(cell).value = value;\n    //   // You can add signature handling logic here if needed\n    //   signature ? (sheet.getCell(cell).note = `Signature: ${signature}`) : null;\n    // });\n\n    const cells = {\n      shift1: \"E2\",\n      shift2: \"F2\",\n      shift3: \"G2\",\n      supervisor: \"H2\"\n    };\n    sheet.getCell(cells.date).value = data.date;\n    sheet.getCell(cells.shift1).value = \"หัวหน้ากะ 1\";\n    sheet.getCell(cells.shift2).value = \"หัวหน้ากะ 2\";\n    sheet.getCell(cells.shift3).value = \"หัวหน้ากะ 3\";\n    sheet.getCell(cells.supervisor).value = \"Supervisor\";\n\n    // -- Header Styling --\n    sheet.getCell(\"A1\").alignment = {\n      vertical: \"middle\",\n      horizontal: \"center\"\n    };\n    sheet.getCell(\"A1\").font = {\n      size: 16,\n      bold: true\n    };\n    console.log(\"header\");\n    console.log(meatSteamGrindingExportData[0]);\n  };\n\n  // -- TABLES --\n  const generateTables = (tableStartAt, batchData) => {\n    // -- Table Styling --\n    sheet.views = [{\n      showGridLines: false\n    }]; // Hide Excel gridlines\n\n    return console.log(\"generateMeatSteamGrindingExcel\");\n  };\n\n  // -- EXCEL FILE GENERATION CONTROLLER --\n  async function handleExport() {\n    generateHeader();\n    generateTables(2, [{\n      date: \"\"\n    }]);\n    // 1. Create header: generateFileHeader()\n    // 2. Create tables the file (loop): generateTables()\n    // 3. Save the file // try ... catch\n\n    // --- Export file ---\n    try {\n      const buffer = await workbook.xlsx.writeBuffer();\n      saveAs(new Blob([buffer]), \"grinding.xlsx\");\n    } catch (error) {\n      console.log(\"Error exporing file: \", error);\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    style: {\n      cursor: \"pointer\",\n      width: \"150px\",\n      height: \"40px\",\n      fontSize: \"20px\"\n    },\n    onClick: handleExport,\n    children: \"Export\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 113,\n    columnNumber: 5\n  }, this);\n}\n_c = MeatSteamGrindingExportButton;\nexport default MeatSteamGrindingExportButton;\nvar _c;\n$RefreshReg$(_c, \"MeatSteamGrindingExportButton\");","map":{"version":3,"names":["ExcelJS","saveAs","jsxDEV","_jsxDEV","MeatSteamGrindingExportButton","meatSteamGrindingExportData","length","children","fileName","_jsxFileName","lineNumber","columnNumber","workbook","Workbook","sheet","addWorksheet","generateHeader","mergeCells","getCell","value","cells","shift1","shift2","shift3","supervisor","date","data","alignment","vertical","horizontal","font","size","bold","console","log","generateTables","tableStartAt","batchData","views","showGridLines","handleExport","buffer","xlsx","writeBuffer","Blob","error","style","cursor","width","height","fontSize","onClick","_c","$RefreshReg$"],"sources":["/Users/oshingp/excel-report/src/components/ExportButton.tsx"],"sourcesContent":["import { JSX, useEffect, useState } from \"react\";\nimport ExcelJS from \"exceljs\";\nimport { saveAs } from \"file-saver\";\nimport dayjs from \"dayjs\";\nimport utc from \"dayjs/plugin/utc\";\n\ninterface BatchData {\n  date: string;\n}\n\ninterface ExportButtonProps {\n  meatSteamGrindingExportData: BatchData[];\n}\n\nfunction MeatSteamGrindingExportButton({\n  meatSteamGrindingExportData,\n}: ExportButtonProps): JSX.Element {\n  // CHECK IF DATA IS EMPTY\n  if (meatSteamGrindingExportData.length === 0) {\n    return <p>No data available for export.</p>;\n  }\n\n  const workbook = new ExcelJS.Workbook();\n  const sheet = workbook.addWorksheet(\"แบบบันทึกการละลายเนื้อ\");\n\n  // -- HEADER --\n  const generateHeader = () => {\n    // Title\n    sheet.mergeCells(\"A1:J1\");\n    sheet.getCell(\"A1\").value =\n      \"แบบบันทึกการบดเนื้อสัตว์ (Stir-Fried Meat Grinding Process Check Sheet)\";\n\n    // Leader and supervisor signatures columns\n\n    // const headerCellValues = [\n    //   {\n    //     cell: \"E2\",\n    //     value: \"หัวหน้ากะ 1\",\n    //     signature: \"\",\n    //   },\n    //   {\n    //     cell: \"F2\",\n    //     value: \"หัวหน้ากะ 2\",\n    //     signature: \"\",\n    //   },\n    //   {\n    //     cell: \"G2\",\n    //     value: \"หัวหน้ากะ 3\",\n    //     signature: \"\",\n    //   },\n    //   {\n    //     cell: \"H2\",\n    //     value: \"Supervisor\",\n    //     signature: \"\",\n    //   },\n    // ];\n\n    // headerCellValues.forEach(({ cell, value, signature }) => {\n    //   sheet.getCell(cell).value = value;\n    //   // You can add signature handling logic here if needed\n    //   signature ? (sheet.getCell(cell).note = `Signature: ${signature}`) : null;\n    // });\n\n    const cells = {\n      shift1: \"E2\",\n      shift2: \"F2\",\n      shift3: \"G2\",\n      supervisor: \"H2\",\n    };\n\n    sheet.getCell(cells.date).value = data.date;\n    sheet.getCell(cells.shift1).value = \"หัวหน้ากะ 1\";\n    sheet.getCell(cells.shift2).value = \"หัวหน้ากะ 2\";\n    sheet.getCell(cells.shift3).value = \"หัวหน้ากะ 3\";\n    sheet.getCell(cells.supervisor).value = \"Supervisor\";\n\n    // -- Header Styling --\n    sheet.getCell(\"A1\").alignment = {\n      vertical: \"middle\",\n      horizontal: \"center\",\n    };\n    sheet.getCell(\"A1\").font = { size: 16, bold: true };\n    console.log(\"header\");\n    console.log(meatSteamGrindingExportData[0]);\n  };\n\n  // -- TABLES --\n  const generateTables = (tableStartAt: number, batchData: BatchData[]) => {\n    // -- Table Styling --\n    sheet.views = [{ showGridLines: false }]; // Hide Excel gridlines\n\n    return console.log(\"generateMeatSteamGrindingExcel\");\n  };\n\n  // -- EXCEL FILE GENERATION CONTROLLER --\n  async function handleExport() {\n    generateHeader();\n    generateTables(2, [{ date: \"\" }]);\n    // 1. Create header: generateFileHeader()\n    // 2. Create tables the file (loop): generateTables()\n    // 3. Save the file // try ... catch\n\n    // --- Export file ---\n    try {\n      const buffer = await workbook.xlsx.writeBuffer();\n      saveAs(new Blob([buffer]), \"grinding.xlsx\");\n    } catch (error) {\n      console.log(\"Error exporing file: \", error);\n    }\n  }\n\n  return (\n    <button\n      style={{\n        cursor: \"pointer\",\n        width: \"150px\",\n        height: \"40px\",\n        fontSize: \"20px\",\n      }}\n      onClick={handleExport}\n    >\n      Export\n    </button>\n  );\n}\n\nexport default MeatSteamGrindingExportButton;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}